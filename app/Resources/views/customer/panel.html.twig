{% extends 'customer/customer.html.twig' %}

{% block body %}
    <div class="row customer-card-infos">

        <div class="col s3">
            {% include 'partials/customer_infos.html.twig' %}
        </div>

        <div class="col s9">
            {% include 'partials/card_infos.html.twig' %}
            {% if customer.card %}
                <div class="card">
                    <div class="card-tabs">
                        <ul class="tabs tabs-fixed-width">
                            <li class="tab"><a class="active" href="#game-sessions-card">Game Sessions</a></li>
                            <li class="tab"><a href="#offers-card">Offers</a></li>
                        </ul>
                    </div>
                    <div class="card-content grey lighten-4">
                        <div id="game-sessions-card">
                            {% include 'partials/game_sessions_infos.html.twig' %}
                        </div>
                        <div id="offers-card">
                            {% include 'partials/offers_infos.html.twig' %}
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="card row offers-infos">
        <h2>My offers</h2>
        {% if card %}
            {% if cardsOffers %}
                <div class="carousel">
                    {% for cardsOffer in cardsOffers %}
                        <div class="carousel-item">
                            {% if cardsOffer.used %}
                                <div class="card-panel red" style="width: 250px; height: 250px;">
                                    <span class="white-text">{{ cardsOffer.offer.description }}</span>
                                    <span>Used</span>
                                </div>
                            {% else %}
                                <div class="card-panel green" style="width: 250px; height: 250px;">
                                    <span class="white-text">{{ cardsOffer.offer.description }}</span>
                                    {% if is_granted('ROLE_STAFF') %}<a href="{{ path('staff_customer_offers_use', { 'id' : cardsOffer.id }) }}" class="btn">Use</a>{% endif %}
                                    {% if is_granted('ROLE_CUSTOMER') %}<span>Usable</span>{% endif %}
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                    {% for lockedOffer in lockedOffers %}
                        <div class="carousel-item">
                            <div class="card-panel grey" style="width: 220px; height: 220px;">
                                <span class="white-text">{{ lockedOffer.description }}</span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>There is no available offers.</p>
            {% endif %}
        {% else %}
            <p>You must have a card to access to our offers.</p>
        {% endif %}
    </div>

{% endblock %}


{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="application/javascript">
        $(document).ready(function(){
            $('.carousel').carousel();
        });
    </script>
{% endblock %}
